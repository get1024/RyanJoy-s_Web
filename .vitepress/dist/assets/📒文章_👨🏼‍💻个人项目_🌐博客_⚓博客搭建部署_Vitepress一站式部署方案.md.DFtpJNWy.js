import{_ as n,B as o,c as i,o as c,j as l,G as t,a3 as d,a as p}from"./chunks/framework.6L905MQs.js";const g="/assets/Vitepress%E4%B8%80%E7%AB%99%E5%BC%8F%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88-1.B4azjpIV.png",u="/assets/Vitepress%E4%B8%80%E7%AB%99%E5%BC%8F%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88-2.BgJsp_Hx.png",h="/assets/Vitepress%E4%B8%80%E7%AB%99%E5%BC%8F%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88-3.CkYuKBmr.png",m="/assets/Vitepress%E4%B8%80%E7%AB%99%E5%BC%8F%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88-4.Cm3jcDMM.png",E="/assets/%E5%9F%9F%E5%90%8D%E6%B3%A8%E5%86%8C.CrfUGaBE.png",b="/assets/%E5%9F%9F%E5%90%8D%E6%B3%A8%E5%86%8C%E6%88%90%E5%8A%9F.DMgLyaMe.png",y="/assets/%E8%A7%A3%E6%9E%90.Bng7cr7V.png",_="/assets/%E5%BF%AB%E9%80%9F%E8%A7%A3%E6%9E%90.CIdorxCo.png",f="/assets/%E8%A7%A3%E6%9E%90%E6%88%90%E5%8A%9F.BRHjH3Mr.png",k="/assets/package-json.D1_egKxk.png",B="/assets/%E9%83%A8%E7%BD%B2%E6%88%90%E5%8A%9F.CI4sOEhB.png",C="/assets/vercel%E5%A2%99.BIdvXMCp.png",A="/assets/domain%E9%85%8D%E7%BD%AE1.Be8SnG0K.png",q="/assets/domain%E9%85%8D%E7%BD%AE2.C7P9SCoq.png",V="/assets/domain%E9%85%8D%E7%BD%AE3.Bx8uz2lT.png",D="/assets/%E6%B7%BB%E5%8A%A0%E5%9F%9F%E5%90%8D.BEWDFtGz.png",j="/assets/%E5%9F%9F%E5%90%8D%E6%B7%BB%E5%8A%A0.CnZ8g-0H.png",N="/assets/free.BjyhFbNC.png",M="/assets/%E5%BF%AB%E9%80%9F%E6%89%AB%E6%8F%8F.CDT3KYOs.png",S="/assets/%E6%9B%B4%E6%94%B9dns.CbN7Xsxi.png",P="/assets/dns%E4%BF%AE%E6%94%B9.BmkvADjx.png",T="/assets/%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE.OeA-jQjS.png",x="/assets/dns%E4%B8%8D%E6%AD%A3%E7%A1%AE.ZtNweHi_.png",z="/assets/%E6%BF%80%E6%B4%BB%E6%88%90%E5%8A%9F.BHFiFevC.png",F="/assets/Cloudflare%E6%8E%A7%E5%88%B6%E5%8F%B0.CyTsbRTi.png",J="/assets/dns%E8%AE%B0%E5%BD%95.ClV8nwdH.png",U="/assets/%E6%B7%BB%E5%8A%A0dns%E8%A7%A3%E6%9E%90.Da181-lK.png",w="/assets/vercel-change-domian.Rira_WnR.png",v="/assets/changesuccess.CmD_1F5S.png",W=JSON.parse('{"title":"Vitepress 一站式部署方案","description":"","frontmatter":{"title":"Vitepress 一站式部署方案","createAt":"2025-01-29T18:26:51.000Z","updateAt":"2025-02-05T22:33:18.000Z","tags":["博客","解决方案"]},"headers":[],"relativePath":"📒文章/👨🏼‍💻个人项目/🌐博客/⚓博客搭建部署/Vitepress一站式部署方案.md","filePath":"📒文章/👨🏼‍💻个人项目/🌐博客/⚓博客搭建部署/Vitepress一站式部署方案.md","lastUpdated":1738769044000}'),I={name:"📒文章/👨🏼‍💻个人项目/🌐博客/⚓博客搭建部署/Vitepress一站式部署方案.md"};function G(H,e,R,Q,O,L){const r=o("ArticleMetadata"),a=o("NolebaseGitContributors"),s=o("NolebaseGitChangelog");return c(),i("div",{"data-pagefind-body":!0,"data-pagefind-meta":"base64:JTdCJTIydGl0bGUlMjIlM0ElMjJWaXRlcHJlc3MlMjAlRTQlQjglODAlRTclQUIlOTklRTUlQkMlOEYlRTklODMlQTglRTclQkQlQjIlRTYlOTYlQjklRTYlQTElODglMjIlMkMlMjJjcmVhdGVBdCUyMiUzQSUyMjIwMjUtMDEtMjlUMTglM0EyNiUzQTUxLjAwMFolMjIlMkMlMjJ1cGRhdGVBdCUyMiUzQSUyMjIwMjUtMDItMDVUMjIlM0EzMyUzQTE4LjAwMFolMjIlMkMlMjJ0YWdzJTIyJTNBJTVCJTIyJUU1JThEJTlBJUU1JUFFJUEyJTIyJTJDJTIyJUU4JUE3JUEzJUU1JTg2JUIzJUU2JTk2JUI5JUU2JUExJTg4JTIyJTVEJTJDJTIyZGF0ZSUyMiUzQTE3Mzg3NjkwNDQwMDAlN0Q="},[e[0]||(e[0]=l("h1",{id:"vitepress-一站式部署方案",tabindex:"-1"},[p("Vitepress 一站式部署方案 "),l("a",{class:"header-anchor",href:"#vitepress-一站式部署方案","aria-label":'Permalink to "Vitepress 一站式部署方案"'},"​")],-1)),t(r),e[1]||(e[1]=d('<div class="tip custom-block"><p class="custom-block-title">作者说</p><p>由于网上的教程纷繁复杂，给前期不会部署的我造成了不小的困惑，索性这里写一篇一站式部署解决方案，希望后来者可以通过遵循此篇，成功完成网站的部署。</p><p>由于文章篇幅稍长，编写可能有些地方不够详尽，如果您对文章有建议，可以评论或者到我的 <code>Repo</code> 提出讨论；如果您愿意贡献此文，欢迎您的 <code>PR</code> 。</p></div><h2 id="域名购买" tabindex="-1">域名购买 <a class="header-anchor" href="#域名购买" aria-label="Permalink to &quot;域名购买&quot;">​</a></h2><p>推荐使用 <code>腾讯云</code> ，因为我懒得写别的教程了……</p><h3 id="简介" tabindex="-1">简介 <a class="header-anchor" href="#简介" aria-label="Permalink to &quot;简介&quot;">​</a></h3><p>腾讯公司旗下的产品，提供云服务器、云存储、云数据库、域名注册等基础云服务</p><p>官网： <a href="https://cloud.tencent.com/" target="_blank" rel="noreferrer">https://cloud.tencent.com/</a></p><p><img src="'+g+'" alt="" loading="lazy"></p><h3 id="注册" tabindex="-1">注册 <a class="header-anchor" href="#注册" aria-label="Permalink to &quot;注册&quot;">​</a></h3><p><a href="https://cloud.tencent.com/" target="_blank" rel="noreferrer">腾讯云首页</a> =&gt; 产品 =&gt; 域名注册</p><p><img src="'+u+'" alt="Vitepress一站式部署方案-2" loading="lazy"></p><p>自己想一个域名搜索，被注册了就换一个，直到有中意的</p><p><img src="'+h+'" alt="Vitepress一站式部署方案-3" loading="lazy"></p><p><img src="'+m+'" alt="" loading="lazy"></p><p>购买完成后，右上角点击进入 <code>控制台</code> =&gt; 域名注册 =&gt; 我的域名</p><p><img src="'+E+'" alt="域名注册" loading="lazy"></p><p><img src="'+b+'" alt="域名注册成功" loading="lazy"></p><p>你就可以看到刚刚注册成功的域名了</p><h3 id="域名解析" tabindex="-1">域名解析 <a class="header-anchor" href="#域名解析" aria-label="Permalink to &quot;域名解析&quot;">​</a></h3><p>腾讯云域名解析，使用的是全资收购的 <a href="https://www.dnspod.cn/" target="_blank" rel="noreferrer">DNSPod</a></p><p><img src="'+y+'" alt="解析" loading="lazy"></p><p>直接点 <code>快速添加解析</code> ，记录值填 <code>你的主机IP</code> 即可</p><p><img src="'+_+'" alt="快速解析" loading="lazy"></p><p>解析成功后，结果如下</p><p><img src="'+f+'" alt="解析成功" loading="lazy"></p><h2 id="部署到-vercel" tabindex="-1">部署到 Vercel <a class="header-anchor" href="#部署到-vercel" aria-label="Permalink to &quot;部署到 Vercel&quot;">​</a></h2><p><a href="https://vercel.com/" target="_blank" rel="noreferrer">Vercel</a> 是一个现代化的静态网站托管平台，它提供了免费的静态网站托管服务，并且支持自动化部署。以下是将 VitePress 项目部署到 Vercel 的步骤：</p><h3 id="准备工作" tabindex="-1">准备工作 <a class="header-anchor" href="#准备工作" aria-label="Permalink to &quot;准备工作&quot;">​</a></h3><ol><li><strong>GitHub 仓库</strong>：确保你的 VitePress 项目已经推送到 GitHub 仓库。</li><li><strong>Vercel 账号</strong>：使用 GitHub 账号登录 <a href="https://vercel.com/" target="_blank" rel="noreferrer">Vercel</a>，身份选择 <code>Hobby</code> 即可。</li></ol><h3 id="导入项目" tabindex="-1">导入项目 <a class="header-anchor" href="#导入项目" aria-label="Permalink to &quot;导入项目&quot;">​</a></h3><ol><li>在 Vercel 控制台点击右上角 <strong>&quot;Add New Project&quot;</strong>。</li><li>选择你要部署的 GitHub 仓库。</li><li>Vercel 会自动检测到这是一个 VitePress 项目。</li></ol><div class="tip custom-block"><p class="custom-block-title">作者说</p><p>这里项目导入建议直接导入整个项目源文件，不要导入 <code>.vitepress/dist</code> 文件夹。这取决于你在 Github 仓库中上传的代码是什么。</p><p>原因是直接上传源文件，Vercel 会自动执行相应的 <code>build</code> 命令，自动部署。</p></div><h3 id="配置构建设置" tabindex="-1">配置构建设置 <a class="header-anchor" href="#配置构建设置" aria-label="Permalink to &quot;配置构建设置&quot;">​</a></h3><p>在项目配置页面：</p><ol><li><p><strong>Project Name:</strong> 设置你的项目名称</p></li><li><p><strong>Framework Preset</strong>: 选择 <code>VitePress</code></p></li><li><p><strong>Root Directory:</strong> <code>./</code></p></li><li><p><strong>Build Command:</strong> 设置为 <code>npm run build</code> 或 <code>pnpm run build</code> 。这里根据你自己的 <code>package.json</code> 文件的内容进行配置。</p><p>我的 <code>package.json</code> 内容如下：</p><p><img src="'+k+'" alt="package-json" loading="lazy"></p><p>因此我的配置为 <code>pnpm build</code> 。</p></li><li><p><strong>Output Directory</strong>: 设置为 <code>.vitepress/dist</code></p></li><li><p><strong>Install Command</strong>: 设置为 <code>npm install</code> 或 <code>pnpm install</code></p></li></ol><h3 id="部署" tabindex="-1">部署 <a class="header-anchor" href="#部署" aria-label="Permalink to &quot;部署&quot;">​</a></h3><ol><li>点击 <strong>&quot;Deploy&quot;</strong> 按钮开始部署</li><li>Vercel 会自动进行构建和部署</li><li>部署完成后，你会得到一个 <code>.vercel.app</code> 结尾的域名</li></ol><p><img src="'+B+'" alt="部署成功" loading="lazy"></p><p>如果你挂了梯子，你点击这一域名便可以成功访问你的网站了，但是如果你没有梯子，便会被墙。如图所示：</p><p><img src="'+C+'" alt="vercel墙" loading="lazy"></p><h3 id="自定义域名" tabindex="-1">自定义域名 <a class="header-anchor" href="#自定义域名" aria-label="Permalink to &quot;自定义域名&quot;">​</a></h3><p>选择 <code>Domain</code> =&gt; <code>Add</code> ，填入你自己的域名即可。我这里使用的是 <code>ryanjoy.top</code> 。</p><p><img src="'+A+'" alt="domain配置1" loading="lazy"></p><p><img src="'+q+'" alt="domain配置2" loading="lazy"></p><p><img src="'+V+'" alt="domain配置3" loading="lazy"></p><h3 id="自动部署" tabindex="-1">自动部署 <a class="header-anchor" href="#自动部署" aria-label="Permalink to &quot;自动部署&quot;">​</a></h3><p>Vercel 会自动监听你的 GitHub 仓库：</p><ul><li>当你推送新的提交到 <code>main</code> 分支时，Vercel 会自动重新部署</li><li>当你创建新的 <code>Pull Request</code> 时，Vercel 会自动创建预览部署</li></ul><h3 id="性能优化" tabindex="-1">性能优化 <a class="header-anchor" href="#性能优化" aria-label="Permalink to &quot;性能优化&quot;">​</a></h3><p>Vercel 提供了一些内置的性能优化：</p><ul><li>自动 CDN 分发</li><li>自动 HTTPS</li><li>自动压缩</li><li>边缘网络加速</li></ul><h3 id="🎯-部署检查清单" tabindex="-1">🎯 部署检查清单 <a class="header-anchor" href="#🎯-部署检查清单" aria-label="Permalink to &quot;🎯 部署检查清单&quot;">​</a></h3><ul class="task-list"><li class="task-list-item"><input type="checkbox" id="cbx_0" checked="true" disabled="true"><label for="cbx_0"> GitHub 仓库设置正确</label></li><li class="task-list-item"><input type="checkbox" id="cbx_1" checked="true" disabled="true"><label for="cbx_1"> 构建命令配置正确</label></li><li class="task-list-item"><input type="checkbox" id="cbx_2" checked="true" disabled="true"><label for="cbx_2"> 输出目录设置正确</label></li><li class="task-list-item"><input type="checkbox" id="cbx_3" checked="true" disabled="true"><label for="cbx_3"> HTTPS 证书自动配置</label></li><li class="task-list-item"><input type="checkbox" id="cbx_4" checked="true" disabled="true"><label for="cbx_4"> 自动部署触发正常</label></li></ul><h2 id="套壳-cf" tabindex="-1">套壳 CF <a class="header-anchor" href="#套壳-cf" aria-label="Permalink to &quot;套壳 CF&quot;">​</a></h2><h3 id="简介-1" tabindex="-1">简介 <a class="header-anchor" href="#简介-1" aria-label="Permalink to &quot;简介&quot;">​</a></h3><p>我们常说的“套 CF”就是给域名套一层 <code>Cloudflare</code> 。<a href="https://www.cloudflare.com/zh-cn/" target="_blank" rel="noreferrer"><strong>Cloudflare</strong></a>（Cloudflare, Inc.）是一家总部位于<a href="https://zh.wikipedia.org/wiki/%E8%88%8A%E9%87%91%E5%B1%B1" title="旧金山" target="_blank" rel="noreferrer">旧金山</a>的跨国科技企业，以向客户提供基于<a href="https://zh.wikipedia.org/wiki/%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86" title="反向代理" target="_blank" rel="noreferrer">反向代理</a>的<a href="https://zh.wikipedia.org/wiki/%E5%85%A7%E5%AE%B9%E5%82%B3%E9%81%9E%E7%B6%B2%E8%B7%AF" title="内容分发网络" target="_blank" rel="noreferrer">内容分发网络</a>（Content Delivery Network, <strong>CDN</strong>）及 <a href="https://zh.wikipedia.org/wiki/%E5%9F%9F%E5%90%8D%E7%B3%BB%E7%BB%9F" target="_blank" rel="noreferrer">分布式域名解析服务</a>（Distributed Domain Name Server）为主要业务。</p><p>常见的<strong>CDN</strong>服务商还有 <a href="https://www.upyun.com/" target="_blank" rel="noreferrer">又拍云</a>、<a href="https://www.qiniu.com/" target="_blank" rel="noreferrer">七牛云</a>、<a href="https://cloud.tencent.com/act/pro/cos" target="_blank" rel="noreferrer">腾讯云COS</a>、<a href="https://www.aliyun.com/product/oss" target="_blank" rel="noreferrer">阿里云OSS</a>等。</p><h3 id="注册-登录" tabindex="-1">注册-登录 <a class="header-anchor" href="#注册-登录" aria-label="Permalink to &quot;注册-登录&quot;">​</a></h3><p>这一步需要科学上网，相信对你没有问题，省略不写。</p><h3 id="如何配置" tabindex="-1">如何配置 <a class="header-anchor" href="#如何配置" aria-label="Permalink to &quot;如何配置&quot;">​</a></h3><p>右上角 <code>添加</code> =&gt; 现有域</p><p><img src="'+D+'" alt="添加域名" loading="lazy"></p><p>输入我们之前注册好的 <a href="#注册">域名</a> ，点击继续</p><p><img src="'+j+'" alt="域名添加" loading="lazy"></p><p>方案选择 <code>FREE</code></p><p><img src="'+N+'" alt="free" loading="lazy"></p><p><code>开始快速扫描</code></p><p><img src="'+M+'" alt="快速扫描" loading="lazy"></p><p>后面提示我们更改 DNS 服务器</p><p><img src="'+S+'" alt="更改dns" loading="lazy"></p><p>回到腾讯云。打开域名界面，勾选域名，修改DNS服务器。</p><p><img src="'+P+'" alt="dns修改" loading="lazy"></p><p>填入 <code>Cloudflare</code> 给出的服务器编码</p><p><img src="'+T+'" alt="服务器配置" loading="lazy"></p><p>点击确定，一直确认，最后提交即可。</p><details class="details custom-block"><summary>当前域名未设置正确的 DNS 服务器，DNS 解析服务未生效。</summary><p>出现图上提示</p><p><img src="'+x+'" alt="dns不正确" loading="lazy"></p><p>忽视即可。因为腾讯云自带的有 DNS 解析服务，我们现在使用了 <code>Cloudflare</code> 的解析，就不用再维护腾讯云的 DNS 解析配置了。</p><p><strong>后续的“二级域名解析”等 DNS 解析服务，我们都只需要在 <code>Cloudflare</code> 之中进行，不用配置腾讯云。</strong></p></details><p>等待一会，会收到 <code>Cloudflare</code> 的邮件</p><p><img src="'+z+'" alt="激活成功" loading="lazy"></p><p>这表示你已经成功激活 <code>Cloudflare</code> 的服务。 <code>Cloudflare</code> 控制台会显示如下</p><p><img src="'+F+'" alt="Cloudflare控制台" loading="lazy"></p><p>点击左侧 DNS =&gt; 记录。可以看到之前腾讯云我们配置的 DNS 解析自动被识别到这里了。</p><p><img src="'+J+'" alt="dns记录" loading="lazy"></p><h2 id="切换域名" tabindex="-1">切换域名 <a class="header-anchor" href="#切换域名" aria-label="Permalink to &quot;切换域名&quot;">​</a></h2><p>由于我先前把博客部署在 <code>ryanjoy.top</code> 上，也即我的根域名上，为了给以后更多网站（个人主页、项目站、项目 Wiki ……）提供空间，我们这里最好把博客部署在 <code>blog.ryanjoy.top</code> 的二级域名上。</p><p>这一操作需要在 <strong>Cloudflare、Vercel 和 腾讯云</strong> 三个地方进行调整，以完成 <strong>VitePress 站点域名从 <code>ryanjoy.top</code> 迁移到 <code>blog.ryanjoy.top</code></strong> 的操作。</p><h3 id="在-cloudflare-添加-blog-ryanjoy-top-解析" tabindex="-1">在 Cloudflare 添加 <code>blog.ryanjoy.top</code> 解析 <a class="header-anchor" href="#在-cloudflare-添加-blog-ryanjoy-top-解析" aria-label="Permalink to &quot;在 Cloudflare 添加 `blog.ryanjoy.top` 解析&quot;">​</a></h3><p>Cloudflare 负责 DNS 解析，因此我们需要在 <strong>Cloudflare</strong> 里添加新的 <code>CNAME</code> 记录：</p><ol><li><strong>进入 Cloudflare 控制台</strong>，选择 <code>ryanjoy.top</code> 域名。</li><li><strong>切换到 &quot;DNS&quot; 选项卡</strong>。</li><li><strong>添加一条新的 <code>CNAME</code> 记录</strong>： <ul><li><strong>名称 (Name)</strong>：<code>blog</code></li><li><strong>目标 (Target)</strong>：<code>cname.vercel-dns.com</code></li><li class="marker-underline"><strong>代理状态 (Proxy status)</strong>：⚠ <strong>保持&quot;仅 DNS&quot; (灰色云朵) 状态，不要启用 Cloudflare 代理（橙色云朵）</strong>，否则可能会导致 Vercel 无法正确处理。（<span class="marker-fakeTitle">bug 解决看这里！</span>）</li></ul></li><li><strong>保存修改</strong>。</li></ol><p><img src="'+U+'" alt="添加dns解析" loading="lazy"></p><h3 id="在-vercel-绑定-blog-ryanjoy-top-域名" tabindex="-1">在 Vercel 绑定 <code>blog.ryanjoy.top</code> 域名 <a class="header-anchor" href="#在-vercel-绑定-blog-ryanjoy-top-域名" aria-label="Permalink to &quot;在 Vercel 绑定 `blog.ryanjoy.top` 域名&quot;">​</a></h3><p>现在我们需要告诉 <strong>Vercel</strong>，我们的 VitePress 站点应该使用 <code>blog.ryanjoy.top</code></p><ol><li><strong>进入 <a href="https://vercel.com/" target="_blank" rel="noreferrer">Vercel 控制台</a></strong>，打开我们的 VitePress 项目。</li><li><strong>进入 &quot;Settings&quot; → &quot;Domains&quot;</strong> 页面。</li><li><strong>点击 <code>ryanjoy.top</code> 域名后的&quot;Edit&quot;</strong>，输入 <code>blog.ryanjoy.top</code> ，然后点击 &quot;Add&quot;。</li><li><strong>Vercel 可能会提示我们需要配置 DNS 解析</strong>，但由于我们已经在 <strong>Cloudflare</strong> 添加了 <code>CNAME</code> 记录，理论上会自动检测成功。</li><li><strong>如果 Vercel 显示 &quot;Invalid Configuration&quot;</strong>： <ul><li>我们可以点击 <strong>&quot;View Instructions&quot;</strong>，按照 Vercel 提供的 CNAME 解析方式检查是否正确。</li><li>确保 Cloudflare 里 <code>blog.ryanjoy.top</code> 的 CNAME 解析 <strong>未启用 Cloudflare 代理</strong>（应该是 <strong>&quot;DNS only&quot;</strong>)。</li></ul></li></ol><p><img src="'+w+'" alt="vercel-change-domian" loading="lazy"></p><p>成功之后，会显示如下</p><p><img src="'+v+'" alt="changesuccess" loading="lazy"></p><h3 id="访问-blog-ryanjoy-top-验证是否生效" tabindex="-1">访问 <code>blog.ryanjoy.top</code> 验证是否生效 <a class="header-anchor" href="#访问-blog-ryanjoy-top-验证是否生效" aria-label="Permalink to &quot;访问 `blog.ryanjoy.top` 验证是否生效&quot;">​</a></h3><ul><li>在 <strong>浏览器中访问 <code>blog.ryanjoy.top</code></strong>，查看是否能够正确加载 VitePress 站点。</li><li>我们也可以在 <code>powershell</code> 使用 ** <code>nslookup blog.ryanjoy.top</code> 或 <code>ping blog.ryanjoy.top</code> ** 检查解析是否生效。</li><li>一般 DNS 解析 <strong>可能需要几分钟到 24 小时生效</strong>，如果访问不成功可以稍等一会儿。</li></ul><h3 id="🎯-总结" tabindex="-1">🎯 总结 <a class="header-anchor" href="#🎯-总结" aria-label="Permalink to &quot;🎯 总结&quot;">​</a></h3><ol><li><strong>Cloudflare</strong>：添加 <code>blog.ryanjoy.top</code> 的 CNAME，指向 <code>cname.vercel-dns.com</code> ，并 <strong>关闭 Cloudflare 代理</strong>（使用&quot;DNS only&quot;）。</li><li><strong>Vercel</strong>：在项目里添加 <code>blog.ryanjoy.top</code> 作为自定义域名。</li></ol><p>这样，VitePress 站点就会成功迁移到 <code>blog.ryanjoy.top</code> 🎉。</p><details class="details custom-block"><summary>为什么要关闭 Cloudflare 代理（使用 &quot;DNS only&quot;）？</summary><p>Cloudflare 提供 <strong>代理模式（橙色云朵）</strong> 和 <strong>DNS 解析模式（灰色云朵，DNS only）</strong>，但在 <strong>Vercel 部署的 VitePress 站点</strong> 上，<strong>必须使用&quot;DNS only&quot;</strong>，原因如下：</p><p><strong>1. Vercel 需要直接管理 HTTPS 证书</strong></p><ul><li><strong>Vercel 自带自动 HTTPS 证书管理</strong>，当你在 Vercel 添加 <code>blog.ryanjoy.top</code> 后，Vercel 会自动为该域名生成并绑定 <strong>Let&#39;s Encrypt SSL 证书</strong>。</li><li><strong>如果启用 Cloudflare 代理（橙色云朵）</strong>，Vercel 可能无法正确检测到域名的真实 IP，导致： <ul><li>SSL 证书验证失败（Vercel 提示 <code>Invalid Configuration</code>）。</li><li>站点可能会出现 <strong>403、525 SSL handshake failed 等错误</strong>。</li></ul></li></ul><p><strong>2. 避免 CNAME 解析问题</strong></p><ul><li>在 Cloudflare <strong>代理模式（橙色云朵）</strong> 下，Cloudflare <strong>会把 CNAME 解析转换为 A 记录</strong>，这样： <ul><li>Vercel 无法正确识别 <code>blog.ryanjoy.top</code> 绑定到它的 IP 地址，导致解析失败。</li><li>可能会导致访问时出现 <strong>&quot;Not Found&quot;</strong> 或 <strong>Vercel 识别错误的 IP</strong>。</li></ul></li></ul><p><strong>3. Cloudflare 代理可能影响 Vercel 的动态功能</strong></p><ul><li>Vercel 提供了一些动态功能（如 Edge Functions、动态 API 路由），如果 Cloudflare 代理开启： <ul><li>可能会影响 Vercel 的<strong>缓存策略</strong>，导致数据不更新或加载异常。</li><li>Cloudflare 可能会拦截 Vercel 的 WebSocket 连接等功能。</li></ul></li></ul><p><strong>如何解决？</strong></p><ol><li><strong>在 Cloudflare DNS 配置里，找到 <code>blog.ryanjoy.top</code> 这条 CNAME 记录。</strong></li><li><strong>确保代理状态为 &quot;DNS only&quot;</strong>（<strong>灰色云朵</strong>）。</li><li><strong>等待 DNS 解析生效</strong>（通常几分钟到 24 小时）。</li><li><strong>在 Vercel 重新检查 <code>blog.ryanjoy.top</code> 的绑定状态</strong>。</li></ol><p><strong>总结</strong></p><p>✅ <strong>正确做法</strong>：使用 <strong>DNS only</strong>（灰色云朵），让 Vercel 正确处理 SSL 证书和域名解析。<br> ❌ <strong>错误做法</strong>：启用 Cloudflare 代理（橙色云朵），会导致 <strong>Vercel SSL 失败、CNAME 解析异常、动态功能受影响</strong>。</p><p class="marker-underline">只要你保持 <strong>Cloudflare 的 CNAME 解析为 &quot;DNS only&quot;</strong>，Vercel 就能正确绑定 <code>blog.ryanjoy.top</code> ，让你的 VitePress 站点稳定运行 🚀！</p></details><h2 id="🎉特别鸣谢" tabindex="-1">🎉特别鸣谢 <a class="header-anchor" href="#🎉特别鸣谢" aria-label="Permalink to &quot;🎉特别鸣谢&quot;">​</a></h2><ul><li><a href="https://yiov.top/website/pages/vercel.html" target="_blank" rel="noreferrer">@Yiov</a> 老兄</li><li><a href="https://zhale.me/" target="_blank" rel="noreferrer">炸了么</a></li></ul>',102)),t(a),t(s)])}const Z=n(I,[["render",G]]);export{W as __pageData,Z as default};
